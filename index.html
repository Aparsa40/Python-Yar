<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ù¾Ø§ÛŒØªÙˆÙ† ÛŒØ§Ø±: Ø³ÙØ± Ø¨Ù‡ Ø¯Ù†ÛŒØ§ÛŒ Ú©Ø¯Ù‡Ø§</title>
<style>
@import url("https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap");

*{margin:0;padding:0;box-sizing:border-box}
body{font-family:"Vazirmatn",sans-serif;background:#f5f5f5;overflow:hidden}

/* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ú©ØªØ§Ø¨ Ø¨Ø§ Ø§ÙÚ©Øª Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ ÙˆØ±Ù‚â€ŒØ²Ø¯Ù† */
.book-container{
  width:100%;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  perspective:1400px; /* ğŸ†• Ø¨Ø±Ø§ÛŒ flip */
  position:relative;
}

/* ØµÙØ­Ù‡â€ŒÙ‡Ø§: Ø±ÙˆÛŒ Ù‡Ù… Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ù†Ø¯ Ùˆ Ø¨Ø§ transform Ø¬Ø§Ø¨Ù‡â€ŒØ¬Ø§ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ */
.page{
  position:absolute;
  width:92%;
  height:88%;
  background:#fff;
  border-radius:12px;
  padding:32px;
  box-shadow:0 20px 40px rgba(0,0,0,.12);
  backface-visibility:hidden;
  transform-style:preserve-3d;
  overflow:auto;
  display:none;          /* ğŸ†• Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù…Ø®ÙÛŒ */
  transform:rotateY(180deg);
  opacity:0;
  z-index:1;
  transition:transform .62s cubic-bezier(.2,.9,.2,1), opacity .62s;
}
.page.active{
  display:block;         /* ğŸ†• ÙÙ‚Ø· ØµÙØ­Ù‡Ù” ÙØ¹Ø§Ù„ Ø¯ÛŒØ¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ */
  transform:rotateY(0deg);
  opacity:1;
  z-index:2;
}

/* Ú©Ø§ÙˆØ± */
/* Ú©Ø§ÙˆØ± Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ */
.cover-page {
  background: #313b23 center center / contain no-repeat; /* contain Ø¨Ø§Ø¹Ø« Ù…ÛŒâ€ŒØ´ÙˆØ¯ ØªØµÙˆÛŒØ± Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¯Ø§Ø®Ù„ ØµÙØ­Ù‡ Ø¨Ø§Ø´Ø¯ Ùˆ Ø²ÙˆÙ… Ù†Ø´ÙˆØ¯ */
  color: #fff;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  position: relative;
  width: 100%;
  height: 100vh; /* Ú©Ù„ Ø§Ø±ØªÙØ§Ø¹ ØµÙØ­Ù‡ */
  overflow: hidden;
}

.cover-page::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 12px;
  background: linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.2));
}

.cover-page * {
  position: relative;
  z-index: 1;
}

.cover-page img {
  max-width: 90%; /* Ø­Ø¯Ø§Ú©Ø«Ø± Ø¹Ø±Ø¶ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¯ÛŒÙˆØ§ÛŒØ³ */
  max-height: 50%; /* Ø§Ø±ØªÙØ§Ø¹ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø¯ÙˆÙ† Ø²ÙˆÙ… */
  object-fit: contain;
  margin-bottom: 18px;
}

.cover-page h1 {
  font-size: 2.6rem;
  font-weight: 800;
  text-shadow: 0 2px 10px rgba(0,0,0,.4);
}

.cover-page p {
  font-size: 1.2rem;
  opacity: .95;
}

/* ÙÙ‡Ø±Ø³Øª Ø¨Ø§ Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† Ù†Ø±Ù… */
.toc-page{background:#667eea;color:#fff}
.toc-title{text-align:center;font-size:1.8rem;margin-bottom:16px}
.chapter{background:rgba(255,255,255,.1);border-radius:10px;margin-bottom:10px;padding:12px;cursor:pointer;transition:.25s}
.chapter:hover{background:rgba(255,255,255,.18)}
.chapter-title{font-weight:700}
.chapter-topics{list-style:none;margin-top:8px;padding-right:12px;max-height:0;overflow:hidden;transition:max-height .35s ease}
.chapter-topics.show{max-height:420px}
.chapter-topics li{padding:6px 0;font-size:.98rem;opacity:.95}
.chapter-topics li[data-goto]{cursor:pointer;text-decoration:underline}

/* ØµÙØ­Ù‡Ù” Ù…Ø­ØªÙˆØ§ */
.content-title{text-align:center;font-size:1.6rem;margin-bottom:14px}
.content-text{font-size:1.04rem;line-height:1.85;margin-bottom:16px}
.code-block{background:#1b1b1b;color:#f6f6f2;border-radius:10px;padding:14px;overflow:auto;font-family:monospace;box-shadow:0 6px 18px rgba(0,0,0,.12)}

/* Ù†Ø§ÙˆØ¨Ø±ÛŒ Ù¾Ø§ÛŒÛŒÙ† */
.navigation{
  position:fixed;bottom:18px;left:50%;transform:translateX(-50%);
  display:flex;gap:10px;z-index:50;flex-wrap:wrap;justify-content:center
}
.nav-btn{
  padding:10px 16px;border-radius:20px;border:0;background:#667eea;color:#fff;
  cursor:pointer;font-weight:700;transition:all .18s
}
.nav-btn:hover{transform:translateY(-3px) scale(1.04);box-shadow:0 8px 24px rgba(86,101,196,.18)}
.nav-btn:disabled{opacity:.45;cursor:not-allowed}
.page-indicator{display:flex;align-items:center;font-weight:800;color:#333;padding:0 8px}

/* Ø¯Ú©Ù…Ù‡Ù” Ø®ÙˆØ§Ù†Ø¯Ù† Ù…ØªÙ†: Ø­Ø§Ù„Øª Play/Pause Ùˆ Hover/Active */
.tts-btn{
  margin-top:10px;padding:8px 14px;border:0;border-radius:22px;background:#28a745;color:#fff;
  font-weight:800;cursor:pointer;transition:all .18s;display:inline-flex;align-items:center;gap:8px
}
.tts-btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(40,167,69,.25)}
.tts-btn.is-playing{background:#d9534f} /* ÙˆÙ‚ØªÛŒ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ Ø§Ø³Øª -> Ù‚Ø±Ù…Ø² (ØªÙˆÙ‚Ù) */
.tts-btn .dot{width:8px;height:8px;border-radius:50%;background:#fff;opacity:.85}
.tts-btn.is-playing .dot{animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:.3}50%{opacity:1}}

@media(max-width:768px){
  .page{width:96%;height:92%;padding:18px}
  .cover-page img{width:78%}
  .cover-page h1{font-size:1.9rem}
}
</style>
</head>
<body>

<div class="book-container">

  <!-- ØµÙØ­Ù‡ 0: Ú©Ø§ÙˆØ± -->
  <div class="page cover-page active" id="page-0" style="background-image:url('cover.png')">
    <img src="cover-small.png" alt="Ù„ÙˆÚ¯Ùˆ Ú©Ø§ÙˆØ±">
    <h1>Ù¾Ø§ÛŒØªÙˆÙ† ÛŒØ§Ø±</h1>
    <p>Ø³ÙØ± Ø¨Ù‡ Ø¯Ù†ÛŒØ§ÛŒ Ú©Ø¯Ù‡Ø§</p>
  </div>

  <!-- ØµÙØ­Ù‡ 1: ÙÙ‡Ø±Ø³Øª -->
  <div class="page toc-page" id="page-1">
    <h2 class="toc-title">ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨</h2>

    <div class="chapter">
      <h3 class="chapter-title">ÙØµÙ„ Ø§ÙˆÙ„: Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§ Ù¾Ø§ÛŒØªÙˆÙ†</h3>
      <ul class="chapter-topics">
        <li>ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ùˆ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</li>
        <li>Ù†ØµØ¨ Ù…Ø­ÛŒØ· ØªÙˆØ³Ø¹Ù‡</li>
        <li data-goto="2">Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ (Ø¨Ù¾Ø± Ø¨Ù‡ ØµÙØ­Ù‡)</li> <!-- ğŸ†• Ù¾Ø±Ø´ Ù…Ø³ØªÙ‚ÛŒÙ… -->
      </ul>
    </div>

    <div class="chapter">
      <h3 class="chapter-title">ÙØµÙ„ Ø¯ÙˆÙ…: Ù…ØªØºÛŒØ±Ù‡Ø§ Ùˆ Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡</h3>
      <ul class="chapter-topics">
        <li>ØªØ¹Ø±ÛŒÙ Ù…ØªØºÛŒØ±Ù‡Ø§</li>
        <li>Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</li>
        <li>Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ Ùˆ Ù…Ø­Ø§Ø³Ø¨Ø§Øª</li>
      </ul>
    </div>

    <div class="chapter">
      <h3 class="chapter-title">ÙØµÙ„ Ø³ÙˆÙ…: Ø³Ø§Ø®ØªØ§Ø±Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„</h3>
      <ul class="chapter-topics">
        <li>Ø¯Ø³ØªÙˆØ±Ø§Øª Ø´Ø±Ø·ÛŒ</li>
        <li>Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§</li>
      </ul>
    </div>
  </div>

  <!-- ØµÙØ­Ù‡ 2: Ù…Ø­ØªÙˆØ§ -->
  <div class="page content-page" id="page-2">
    <h2 class="content-title">ÙØµÙ„ Ø§ÙˆÙ„: Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§ Ù¾Ø§ÛŒØªÙˆÙ†</h2>
    <div class="content-text" id="content-text-1">
      <p>Ù¾Ø§ÛŒØªÙˆÙ† Ø²Ø¨Ø§Ù† Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³ÛŒ Ø³Ø·Ø­ Ø¨Ø§Ù„Ø§ Ø§Ø³Øª Ú©Ù‡ Ø¨Ø³ÛŒØ§Ø± Ø³Ø§Ø¯Ù‡ Ùˆ Ø®ÙˆØ§Ù†Ø§ Ù…ÛŒâ€ŒØ¨Ø§Ø´Ø¯.</p>
      <p>Ø§ÛŒÙ† Ø²Ø¨Ø§Ù† Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ Ø§ÙØ±Ø§Ø¯ Ù…Ø¨ØªØ¯ÛŒ Ø¹Ø§Ù„ÛŒØ³Øª Ùˆ Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ù‡Ù… Ú©Ø§Ù…Ù„Ø§Ù‹ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ Ø§Ø³Øª.</p>
    </div>
    <div class="code-block">
<pre># Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡
print("Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§!")</pre>
    </div>

    <!-- ğŸ†• Ø¯Ú©Ù…Ù‡Ù” Play/Pause Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† Ù…ØªÙ† -->
    <button class="tts-btn" data-target="content-text-1" onclick="toggleRead(this)">
      <span class="dot"></span> â–¶ï¸ Ø¨Ø®ÙˆÙ†
    </button>
  </div>

  <!-- ØµÙØ­Ù‡ 3: Ù†Ù…ÙˆÙ†Ù‡Ù” Ø¯ÙˆÙ… Ù…Ø­ØªÙˆØ§ (Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¬Ø§Ø¨Ù‡â€ŒØ¬Ø§ÛŒÛŒ ÙˆØ§Ù‚Ø¹ÛŒ ØµÙØ­Ø§Øª) -->
  <div class="page content-page" id="page-3">
    <h2 class="content-title">ÙØµÙ„ Ø¯ÙˆÙ…: Ù…ØªØºÛŒØ±Ù‡Ø§</h2>
    <div class="content-text" id="content-text-2">
      <p>Ø¯Ø± Ù¾Ø§ÛŒØªÙˆÙ† Ù†ÛŒØ§Ø²ÛŒ Ø¨Ù‡ Ø§Ø¹Ù„Ø§Ù… Ù†ÙˆØ¹ Ù…ØªØºÛŒØ± Ù†ÛŒØ³ØªØ› Ø®ÙˆØ¯Ø´ Ø§Ø² Ù…Ù‚Ø¯Ø§Ø± Ù†ÙˆØ¹ Ø±Ø§ Ø§Ø³ØªÙ†Ø¨Ø§Ø· Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>
    </div>
    <div class="code-block">
<pre>x = 42
y = "Ø³Ù„Ø§Ù…"
z = 3.14</pre>
    </div>
    <button class="tts-btn" data-target="content-text-2" onclick="toggleRead(this)">
      <span class="dot"></span> â–¶ï¸ Ø¨Ø®ÙˆÙ†
    </button>
  </div>

</div>

<!-- Ù†Ø§ÙˆØ¨Ø±ÛŒ -->
<div class="navigation">
  <button class="nav-btn" id="prevBtn" onclick="previousPage()">ØµÙØ­Ù‡ Ù‚Ø¨Ù„</button>
  <div class="page-indicator" id="pageIndicator">1 / 4</div>
  <button class="nav-btn" id="nextBtn" onclick="nextPage()">ØµÙØ­Ù‡ Ø¨Ø¹Ø¯</button>
</div>

<script>
/* ============================================================
   Ù…Ø¯ÛŒØ±ÛŒØª ØµÙØ­Ø§Øª Ø¨Ø§ flip ÙˆØ§Ù‚Ø¹ÛŒ + Ø¨Ø¯ÙˆÙ† Ø§Ø³Ú©Ø±ÙˆÙ„ Ù†Ø§Ø®ÙˆØ§Ø³ØªÙ‡
   ============================================================ */
let currentPage = 0;
const pages = Array.from(document.querySelectorAll('.page'));
const totalPages = pages.length;

/* ğŸ†• ØµØ¯Ø§ÛŒ ÙˆØ±Ù‚â€ŒØ²Ø¯Ù† Ø±Ø§ ÛŒÚ© Ø¨Ø§Ø± Ø¨Ø³Ø§Ø²ÛŒÙ… ØªØ§ Ù‡Ø± Ø¨Ø§Ø± Ø§Ø² Ø§ÙˆÙ„ Ù„ÙˆØ¯ Ù†Ø´ÙˆØ¯ */
const flipAudio = new Audio('flip.mp3'); // ÙØ§ÛŒÙ„ Ø±Ø§ Ú©Ù†Ø§Ø± index.html Ø¨Ú¯Ø°Ø§Ø±
flipAudio.preload = 'auto';

function updateNav(i){
  prevBtn.disabled = (i===0);
  nextBtn.disabled = (i===totalPages-1);
  pageIndicator.textContent = `${i+1} / ${totalPages}`;
}

/* ğŸ†• Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¬Ù‡Øªâ€ŒØ¯Ø§Ø± Ùˆ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ú©Ø±ÙˆÙ„ Ø§Ø¶Ø§ÙÛŒ */
function showPage(targetIndex){
  if(targetIndex === currentPage || targetIndex<0 || targetIndex>=totalPages) return;

  const from = pages[currentPage];
  const to   = pages[targetIndex];
  const forward = targetIndex > currentPage;

  // Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ØµÙØ­Ù‡ Ù…Ù‚ØµØ¯
  to.style.display = 'block';
  to.style.transform = `rotateY(${forward ? 180 : -180}deg)`;
  to.style.opacity = 0;

  // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø®Ø±ÙˆØ¬ ØµÙØ­Ù‡ ÙØ¹Ù„ÛŒ
  from.style.transform = `rotateY(${forward ? -180 : 180}deg)`;
  from.style.opacity = 0;

  // force reflow
  void to.offsetHeight;

  // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† ÙˆØ±ÙˆØ¯ ØµÙØ­Ù‡ Ù…Ù‚ØµØ¯
  to.classList.add('active');

  // Ù¾Ø³ Ø§Ø² Ù¾Ø§ÛŒØ§Ù† Ø§Ù†ÛŒÙ…ÛŒØ´Ù†ØŒ ØµÙØ­Ù‡ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ Ù…Ø®ÙÛŒ Ú©Ù†
  setTimeout(()=>{
    pages.forEach((p,i)=>{
      if(i===targetIndex){
        p.classList.add('active');
        p.style.display='block';
        p.style.transform='rotateY(0deg)';
        p.style.opacity=1;
      }else{
        p.classList.remove('active');
        p.style.display='none';
        p.style.opacity=0;
        p.style.transform='rotateY(180deg)';
      }
    });

    currentPage = targetIndex;
    updateNav(currentPage);
    pages[currentPage].scrollTop = 0; // Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø¨ØªØ¯Ø§ÛŒ ØµÙØ­Ù‡
    try{ flipAudio.currentTime=0; flipAudio.play(); }catch(e){}
  }, 660); // Ú©Ù…ÛŒ Ø¨ÛŒØ´ØªØ± Ø§Ø² duration ØªØ±Ù†Ø²ÛŒØ´Ù†
}

function nextPage(){ showPage(currentPage+1); }
function previousPage(){ showPage(currentPage-1); }

document.addEventListener('keydown', e=>{
  if(e.key==='ArrowRight'||e.key==='ArrowDown') nextPage();
  if(e.key==='ArrowLeft'||e.key==='ArrowUp') previousPage();
});

/* Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† ÙÙ‡Ø±Ø³Øª + Ù¾Ø±Ø´ Ø¨Ù‡ ØµÙØ­Ù‡ Ø¨Ø§ data-goto */
document.querySelectorAll('.chapter').forEach(ch=>{
  const title = ch.querySelector('.chapter-title');
  const ul = ch.querySelector('.chapter-topics');
  title.addEventListener('click', ()=> ul.classList.toggle('show'));
  ul.querySelectorAll('[data-goto]').forEach(li=>{
    li.addEventListener('click', ()=>{
      const idx = parseInt(li.getAttribute('data-goto'),10);
      showPage(idx);
    });
  });
});

/* Ø§ÙˆÙ„ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ: ÙÙ‚Ø· ØµÙØ­Ù‡ 0 Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ */
(function init(){
  pages.forEach((p,i)=>{
    if(i===0){
      p.style.display='block';
      p.classList.add('active');
      p.style.transform='rotateY(0deg)';
      p.style.opacity=1;
    }else{
      p.style.display='none';
      p.style.opacity=0;
      p.style.transform='rotateY(180deg)';
    }
  });
  updateNav(0);
})();

/* ============================================================
   TTS Ø¯Ø§Ø®Ù„ÛŒ (SpeechSynthesis) Ø¨Ø§ Ø¯Ú©Ù…Ù‡ Play/Pause
   + Ø§Ø³Ú©Ù„Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± TTS (Ú©Ø§Ù…Ù†Øªâ€ŒØ´Ø¯Ù‡)
   ============================================================ */
/* TTS Ø¨Ø§ Play/Pause Ùˆ ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ø¯Ú©Ù…Ù‡
   ============================================================ */
/*const TTS = {
  isPlaying:false,
  utterance:null,
  currentTargetId:null
};

async function toggleRead(btn){
  const targetId = btn.dataset.target;
  const textEl = document.getElementById(targetId);
  if(!textEl) return;

  // Ø§Ú¯Ø± Ù‡Ù…Ø§Ù† Ø¨Ø®Ø´ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ Ø§Ø³Øª -> ØªÙˆÙ‚Ù
  if(TTS.isPlaying && TTS.currentTargetId === targetId){
    speechSynthesis.cancel();
    return;
  }

  // Ø§Ú¯Ø± Ø¨Ø®Ø´ Ø¯ÛŒÚ¯Ø±ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ Ø§Ø³Øª -> Ù‚Ø·Ø¹ Ø¢Ù†
  if(TTS.isPlaying && TTS.currentTargetId !== targetId){
    speechSynthesis.cancel();
  }

  const text = textEl.innerText.trim();
  if(!text) return;

  // --- Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ù‡Ù…Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Ø­Ø§Ù„Øª Ø§ÙˆÙ„ÛŒÙ‡
  document.querySelectorAll('.tts-btn').forEach(b=>{
    b.classList.remove('is-playing');
    b.style.background = '#28a745'; // Ø±Ù†Ú¯ Ø§ÙˆÙ„ÛŒÙ‡ Ø³Ø¨Ø²
    b.innerHTML = '<span class="dot"></span> â–¶ï¸ Ø¨Ø®ÙˆÙ†';
  });

  // --- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² SpeechSynthesis Ø¯Ø§Ø®Ù„ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'fa-IR';
  utter.rate = 1.0;
  utter.pitch = 1.0;

  utter.onstart = () => {
    TTS.isPlaying = true;
    TTS.currentTargetId = targetId;
    TTS.utterance = utter;

    btn.classList.add('is-playing');
    btn.style.background = '#d9534f'; // Ø±Ù†Ú¯ Ù‚Ø±Ù…Ø² Ù‡Ù†Ú¯Ø§Ù… Ù¾Ø®Ø´
    btn.innerHTML = '<span class="dot"></span> â¸ï¸ ØªÙˆÙ‚Ù';
  };

  utter.onend = utter.onerror = () => {
    TTS.isPlaying = false;
    TTS.currentTargetId = null;
    TTS.utterance = null;

    btn.classList.remove('is-playing');
    btn.style.background = '#28a745'; // Ø¨Ø±Ú¯Ø´Øª Ø¨Ù‡ Ø³Ø¨Ø²
    btn.innerHTML = '<span class="dot"></span> â–¶ï¸ Ø¨Ø®ÙˆÙ†';
  };

  try {
    speechSynthesis.speak(utter);
  } catch(err) {
    console.warn('SpeechSynthesis Ù…Ø´Ú©Ù„ Ø¯Ø§Ø´Øª:', err);

    // --- Ø§Ø³Ú©Ù„Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± TTS (Ú©Ø§Ù…Ù†Øªâ€ŒØ´Ø¯Ù‡)
    /*
    try {
      const response = await fetch(`https://your-tts-server.com/api/tts?text=${encodeURIComponent(text)}`);
      const blob = await response.blob();
      const audioUrl = URL.createObjectURL(blob);
      const audio = new Audio(audioUrl);
      audio.play();
      audio.onended = () => {
        TTS.isPlaying = false;
        TTS.currentTargetId = null;
        btn.classList.remove('is-playing');
        btn.style.background = '#28a745';
        btn.innerHTML = '<span class="dot"></span> â–¶ï¸ Ø¨Ø®ÙˆÙ†';
      };
    } catch(serverErr){
      console.warn('Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± TTS:', serverErr);
    }
    */
  


/* ğŸ§© Ø§Ø³Ú©Ù„Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± TTS (Ø¯Ù„Ø®ÙˆØ§Ù‡) â€” Ø¨Ø¹Ø¯Ø§Ù‹ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†
async function requestTTSFromServer(text){
  // Ù†Ù…ÙˆÙ†Ù‡: Ø³Ø±ÙˆØ± Ø´Ù…Ø§ ÛŒÚ© MP3 Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯
  const res = await fetch('http://localhost:5000/tts', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({ text, lang:'fa-IR' })
  });
  if(!res.ok) throw new Error('TTS server error');
  const blob = await res.blob();
  const url = URL.createObjectURL(blob);
  const audio = new Audio(url);
  audio.play();
}
*/
</script>
</body>
</html>
