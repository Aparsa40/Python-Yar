<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>پایتون یار: سفر به دنیای کدها</title>
<style>
@import url("https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap");

*{margin:0;padding:0;box-sizing:border-box}
body{font-family:"Vazirmatn",sans-serif;background:#f5f5f5;overflow:hidden}

/* کانتینر کتاب با افکت سه‌بعدی برای ورق‌زدن */
.book-container{
  width:100%;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  perspective:1400px; /* 🆕 برای flip */
  position:relative;
}

/* صفحه‌ها: روی هم قرار می‌گیرند و با transform جابه‌جا می‌شوند */
.page{
  position:absolute;
  width:92%;
  height:88%;
  background:#fff;
  border-radius:12px;
  padding:32px;
  box-shadow:0 20px 40px rgba(0,0,0,.12);
  backface-visibility:hidden;
  transform-style:preserve-3d;
  overflow:auto;
  display:none;          /* 🆕 پیش‌فرض مخفی */
  transform:rotateY(180deg);
  opacity:0;
  z-index:1;
  transition:transform .62s cubic-bezier(.2,.9,.2,1), opacity .62s;
}
.page.active{
  display:block;         /* 🆕 فقط صفحهٔ فعال دیده می‌شود */
  transform:rotateY(0deg);
  opacity:1;
  z-index:2;
}

/* کاور */
/* کاور اصلاح شده */
.cover-page {
  background: #313b23 center center / contain no-repeat; /* contain باعث می‌شود تصویر کاملاً داخل صفحه باشد و زوم نشود */
  color: #fff;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  position: relative;
  width: 100%;
  height: 100vh; /* کل ارتفاع صفحه */
  overflow: hidden;
}

.cover-page::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 12px;
  background: linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.2));
}

.cover-page * {
  position: relative;
  z-index: 1;
}

.cover-page img {
  max-width: 90%; /* حداکثر عرض برای هر دیوایس */
  max-height: 50%; /* ارتفاع مناسب بدون زوم */
  object-fit: contain;
  margin-bottom: 18px;
}

.cover-page h1 {
  font-size: 2.6rem;
  font-weight: 800;
  text-shadow: 0 2px 10px rgba(0,0,0,.4);
}

.cover-page p {
  font-size: 1.2rem;
  opacity: .95;
}

/* فهرست با آکاردئون نرم */
.toc-page{background:#667eea;color:#fff}
.toc-title{text-align:center;font-size:1.8rem;margin-bottom:16px}
.chapter{background:rgba(255,255,255,.1);border-radius:10px;margin-bottom:10px;padding:12px;cursor:pointer;transition:.25s}
.chapter:hover{background:rgba(255,255,255,.18)}
.chapter-title{font-weight:700}
.chapter-topics{list-style:none;margin-top:8px;padding-right:12px;max-height:0;overflow:hidden;transition:max-height .35s ease}
.chapter-topics.show{max-height:420px}
.chapter-topics li{padding:6px 0;font-size:.98rem;opacity:.95}
.chapter-topics li[data-goto]{cursor:pointer;text-decoration:underline}

/* صفحهٔ محتوا */
.content-title{text-align:center;font-size:1.6rem;margin-bottom:14px}
.content-text{font-size:1.04rem;line-height:1.85;margin-bottom:16px}
.code-block{background:#1b1b1b;color:#f6f6f2;border-radius:10px;padding:14px;overflow:auto;font-family:monospace;box-shadow:0 6px 18px rgba(0,0,0,.12)}

/* ناوبری پایین */
.navigation{
  position:fixed;bottom:18px;left:50%;transform:translateX(-50%);
  display:flex;gap:10px;z-index:50;flex-wrap:wrap;justify-content:center
}
.nav-btn{
  padding:10px 16px;border-radius:20px;border:0;background:#667eea;color:#fff;
  cursor:pointer;font-weight:700;transition:all .18s
}
.nav-btn:hover{transform:translateY(-3px) scale(1.04);box-shadow:0 8px 24px rgba(86,101,196,.18)}
.nav-btn:disabled{opacity:.45;cursor:not-allowed}
.page-indicator{display:flex;align-items:center;font-weight:800;color:#333;padding:0 8px}

/* دکمهٔ خواندن متن: حالت Play/Pause و Hover/Active */
.tts-btn{
  margin-top:10px;padding:8px 14px;border:0;border-radius:22px;background:#28a745;color:#fff;
  font-weight:800;cursor:pointer;transition:all .18s;display:inline-flex;align-items:center;gap:8px
}
.tts-btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(40,167,69,.25)}
.tts-btn.is-playing{background:#d9534f} /* وقتی در حال پخش است -> قرمز (توقف) */
.tts-btn .dot{width:8px;height:8px;border-radius:50%;background:#fff;opacity:.85}
.tts-btn.is-playing .dot{animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:.3}50%{opacity:1}}

@media(max-width:768px){
  .page{width:96%;height:92%;padding:18px}
  .cover-page img{width:78%}
  .cover-page h1{font-size:1.9rem}
}
</style>
</head>
<body>

<div class="book-container">

  <!-- صفحه 0: کاور -->
  <div class="page cover-page active" id="page-0" style="background-image:url('cover.png')">
    <img src="cover-small.png" alt="لوگو کاور">
    <h1>پایتون یار</h1>
    <p>سفر به دنیای کدها</p>
  </div>

  <!-- صفحه 1: فهرست -->
  <div class="page toc-page" id="page-1">
    <h2 class="toc-title">فهرست مطالب</h2>

    <div class="chapter">
      <h3 class="chapter-title">فصل اول: آشنایی با پایتون</h3>
      <ul class="chapter-topics">
        <li>تاریخچه و ویژگی‌ها</li>
        <li>نصب محیط توسعه</li>
        <li data-goto="2">اولین برنامه (بپر به صفحه)</li> <!-- 🆕 پرش مستقیم -->
      </ul>
    </div>

    <div class="chapter">
      <h3 class="chapter-title">فصل دوم: متغیرها و انواع داده</h3>
      <ul class="chapter-topics">
        <li>تعریف متغیرها</li>
        <li>انواع داده‌ها</li>
        <li>رشته‌ها و محاسبات</li>
      </ul>
    </div>

    <div class="chapter">
      <h3 class="chapter-title">فصل سوم: ساختارهای کنترل</h3>
      <ul class="chapter-topics">
        <li>دستورات شرطی</li>
        <li>حلقه‌ها</li>
      </ul>
    </div>
  </div>

  <!-- صفحه 2: محتوا -->
  <div class="page content-page" id="page-2">
    <h2 class="content-title">فصل اول: آشنایی با پایتون</h2>
    <div class="content-text" id="content-text-1">
      <p>پایتون زبان برنامه‌نویسی سطح بالا است که بسیار ساده و خوانا می‌باشد.</p>
      <p>این زبان برای ورود افراد مبتدی عالیست و برای پروژه‌های بزرگ هم کاملاً قدرتمند است.</p>
    </div>
    <div class="code-block">
<pre># اولین برنامه
print("سلام دنیا!")</pre>
    </div>

    <!-- 🆕 دکمهٔ Play/Pause برای خواندن متن -->
    <button class="tts-btn" data-target="content-text-1" onclick="toggleRead(this)">
      <span class="dot"></span> ▶️ بخون
    </button>
  </div>

  <!-- صفحه 3: نمونهٔ دوم محتوا (برای تست جابه‌جایی واقعی صفحات) -->
  <div class="page content-page" id="page-3">
    <h2 class="content-title">فصل دوم: متغیرها</h2>
    <div class="content-text" id="content-text-2">
      <p>در پایتون نیازی به اعلام نوع متغیر نیست؛ خودش از مقدار نوع را استنباط می‌کند.</p>
    </div>
    <div class="code-block">
<pre>x = 42
y = "سلام"
z = 3.14</pre>
    </div>
    <button class="tts-btn" data-target="content-text-2" onclick="toggleRead(this)">
      <span class="dot"></span> ▶️ بخون
    </button>
  </div>

</div>

<!-- ناوبری -->
<div class="navigation">
  <button class="nav-btn" id="prevBtn" onclick="previousPage()">صفحه قبل</button>
  <div class="page-indicator" id="pageIndicator">1 / 4</div>
  <button class="nav-btn" id="nextBtn" onclick="nextPage()">صفحه بعد</button>
</div>

<script>
/* ============================================================
   مدیریت صفحات با flip واقعی + بدون اسکرول ناخواسته
   ============================================================ */
let currentPage = 0;
const pages = Array.from(document.querySelectorAll('.page'));
const totalPages = pages.length;

/* 🆕 صدای ورق‌زدن را یک بار بسازیم تا هر بار از اول لود نشود */
const flipAudio = new Audio('flip.mp3'); // فایل را کنار index.html بگذار
flipAudio.preload = 'auto';

function updateNav(i){
  prevBtn.disabled = (i===0);
  nextBtn.disabled = (i===totalPages-1);
  pageIndicator.textContent = `${i+1} / ${totalPages}`;
}

/* 🆕 نمایش صفحه با انیمیشن جهت‌دار و بدون اسکرول اضافی */
function showPage(targetIndex){
  if(targetIndex === currentPage || targetIndex<0 || targetIndex>=totalPages) return;

  const from = pages[currentPage];
  const to   = pages[targetIndex];
  const forward = targetIndex > currentPage;

  // آماده‌سازی صفحه مقصد
  to.style.display = 'block';
  to.style.transform = `rotateY(${forward ? 180 : -180}deg)`;
  to.style.opacity = 0;

  // انیمیشن خروج صفحه فعلی
  from.style.transform = `rotateY(${forward ? -180 : 180}deg)`;
  from.style.opacity = 0;

  // force reflow
  void to.offsetHeight;

  // انیمیشن ورود صفحه مقصد
  to.classList.add('active');

  // پس از پایان انیمیشن، صفحه قبلی را مخفی کن
  setTimeout(()=>{
    pages.forEach((p,i)=>{
      if(i===targetIndex){
        p.classList.add('active');
        p.style.display='block';
        p.style.transform='rotateY(0deg)';
        p.style.opacity=1;
      }else{
        p.classList.remove('active');
        p.style.display='none';
        p.style.opacity=0;
        p.style.transform='rotateY(180deg)';
      }
    });

    currentPage = targetIndex;
    updateNav(currentPage);
    pages[currentPage].scrollTop = 0; // همیشه ابتدای صفحه
    try{ flipAudio.currentTime=0; flipAudio.play(); }catch(e){}
  }, 660); // کمی بیشتر از duration ترنزیشن
}

function nextPage(){ showPage(currentPage+1); }
function previousPage(){ showPage(currentPage-1); }

document.addEventListener('keydown', e=>{
  if(e.key==='ArrowRight'||e.key==='ArrowDown') nextPage();
  if(e.key==='ArrowLeft'||e.key==='ArrowUp') previousPage();
});

/* آکاردئون فهرست + پرش به صفحه با data-goto */
document.querySelectorAll('.chapter').forEach(ch=>{
  const title = ch.querySelector('.chapter-title');
  const ul = ch.querySelector('.chapter-topics');
  title.addEventListener('click', ()=> ul.classList.toggle('show'));
  ul.querySelectorAll('[data-goto]').forEach(li=>{
    li.addEventListener('click', ()=>{
      const idx = parseInt(li.getAttribute('data-goto'),10);
      showPage(idx);
    });
  });
});

/* اولیه‌سازی: فقط صفحه 0 نمایش داده شود */
(function init(){
  pages.forEach((p,i)=>{
    if(i===0){
      p.style.display='block';
      p.classList.add('active');
      p.style.transform='rotateY(0deg)';
      p.style.opacity=1;
    }else{
      p.style.display='none';
      p.style.opacity=0;
      p.style.transform='rotateY(180deg)';
    }
  });
  updateNav(0);
})();

/* ============================================================
   TTS داخلی (SpeechSynthesis) با دکمه Play/Pause
   + اسکلت اتصال به سرور TTS (کامنت‌شده)
   ============================================================ */
/* TTS با Play/Pause و تغییر رنگ دکمه
   ============================================================ */
/*const TTS = {
  isPlaying:false,
  utterance:null,
  currentTargetId:null
};

async function toggleRead(btn){
  const targetId = btn.dataset.target;
  const textEl = document.getElementById(targetId);
  if(!textEl) return;

  // اگر همان بخش در حال پخش است -> توقف
  if(TTS.isPlaying && TTS.currentTargetId === targetId){
    speechSynthesis.cancel();
    return;
  }

  // اگر بخش دیگری در حال پخش است -> قطع آن
  if(TTS.isPlaying && TTS.currentTargetId !== targetId){
    speechSynthesis.cancel();
  }

  const text = textEl.innerText.trim();
  if(!text) return;

  // --- بازگرداندن همه دکمه‌ها به حالت اولیه
  document.querySelectorAll('.tts-btn').forEach(b=>{
    b.classList.remove('is-playing');
    b.style.background = '#28a745'; // رنگ اولیه سبز
    b.innerHTML = '<span class="dot"></span> ▶️ بخون';
  });

  // --- استفاده از SpeechSynthesis داخلی مرورگر
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'fa-IR';
  utter.rate = 1.0;
  utter.pitch = 1.0;

  utter.onstart = () => {
    TTS.isPlaying = true;
    TTS.currentTargetId = targetId;
    TTS.utterance = utter;

    btn.classList.add('is-playing');
    btn.style.background = '#d9534f'; // رنگ قرمز هنگام پخش
    btn.innerHTML = '<span class="dot"></span> ⏸️ توقف';
  };

  utter.onend = utter.onerror = () => {
    TTS.isPlaying = false;
    TTS.currentTargetId = null;
    TTS.utterance = null;

    btn.classList.remove('is-playing');
    btn.style.background = '#28a745'; // برگشت به سبز
    btn.innerHTML = '<span class="dot"></span> ▶️ بخون';
  };

  try {
    speechSynthesis.speak(utter);
  } catch(err) {
    console.warn('SpeechSynthesis مشکل داشت:', err);

    // --- اسکلت اتصال به سرور TTS (کامنت‌شده)
    /*
    try {
      const response = await fetch(`https://your-tts-server.com/api/tts?text=${encodeURIComponent(text)}`);
      const blob = await response.blob();
      const audioUrl = URL.createObjectURL(blob);
      const audio = new Audio(audioUrl);
      audio.play();
      audio.onended = () => {
        TTS.isPlaying = false;
        TTS.currentTargetId = null;
        btn.classList.remove('is-playing');
        btn.style.background = '#28a745';
        btn.innerHTML = '<span class="dot"></span> ▶️ بخون';
      };
    } catch(serverErr){
      console.warn('خطا در اتصال به سرور TTS:', serverErr);
    }
    */
  


/* 🧩 اسکلت اتصال به سرور TTS (دلخواه) — بعداً جایگزین کن
async function requestTTSFromServer(text){
  // نمونه: سرور شما یک MP3 برمی‌گرداند
  const res = await fetch('http://localhost:5000/tts', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({ text, lang:'fa-IR' })
  });
  if(!res.ok) throw new Error('TTS server error');
  const blob = await res.blob();
  const url = URL.createObjectURL(blob);
  const audio = new Audio(url);
  audio.play();
}
*/
</script>
</body>
</html>
